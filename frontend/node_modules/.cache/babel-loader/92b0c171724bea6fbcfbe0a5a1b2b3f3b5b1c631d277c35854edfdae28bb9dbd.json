{"ast":null,"code":"// frontend/src/pages/LeaveHistory.js\nimport React,{useState,useEffect}from'react';import axios from'axios';import{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from\"react/jsx-runtime\";export default function LeaveHistory(){const[leaveHistory,setLeaveHistory]=useState([]);const[error,setError]=useState(null);const[selectedLeave,setSelectedLeave]=useState(null);const[isOverlayOpen,setIsOverlayOpen]=useState(false);const user=JSON.parse(localStorage.getItem('user'));useEffect(()=>{if(!user)return;axios.get('http://localhost:5000/api/leave/history',{params:{userId:user.id}}).then(response=>{setLeaveHistory(response.data.history);setError(null);}).catch(err=>{setError('Failed to fetch leave history.');console.error(err);});},[user]);const handleViewRequest=leave=>{cancelRequest(leave);setSelectedLeave(leave);setIsOverlayOpen(true);};const handleCloseOverlay=()=>{setIsOverlayOpen(false);setSelectedLeave(null);};async function cancelRequest(id){await axios.delete('http://localhost:5000/api/leave/deleteRequest',{params:{lrId:id}}).then(response=>{console.log(response.data.status);}).catch(err=>{console.log(err);});}return/*#__PURE__*/_jsxs(\"div\",{className:\"leave-history\",children:[error&&/*#__PURE__*/_jsx(\"p\",{className:\"error\",children:error}),/*#__PURE__*/_jsx(\"div\",{className:\"table-wrapper\",children:leaveHistory.length==0?/*#__PURE__*/_jsx(_Fragment,{children:\"NO LEAVE REQUESTED\"}):/*#__PURE__*/_jsxs(\"table\",{className:\"styled-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"No\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Leave Type\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Reason\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Approved/Rejected By\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Rejected Description\"}),/*#__PURE__*/_jsx(\"th\",{children:\"No of Days\"}),/*#__PURE__*/_jsx(\"th\",{children:\"From\"}),/*#__PURE__*/_jsx(\"th\",{children:\"To\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:leaveHistory.map((leave,index)=>/*#__PURE__*/_jsxs(\"tr\",{onClick:()=>handleViewRequest(leave),children:[/*#__PURE__*/_jsx(\"td\",{children:index+1}),/*#__PURE__*/_jsx(\"td\",{children:leave.leaveType}),/*#__PURE__*/_jsx(\"td\",{children:leave.description}),/*#__PURE__*/_jsxs(\"td\",{children:[leave.status,\" \",/*#__PURE__*/_jsxs(\"label\",{for:\"file\",children:[\"(\",leave.steps_completed,\"/\",leave.steps_required,\")\"]}),/*#__PURE__*/_jsx(\"progress\",{id:\"file\",value:leave.steps_completed,max:leave.steps_required})]}),/*#__PURE__*/_jsx(\"td\",{children:leave.approved_by_name||leave.rejected_by_name||'-'}),/*#__PURE__*/_jsx(\"td\",{children:leave.rejection_reason||'-'}),/*#__PURE__*/_jsx(\"td\",{children:leave.no_of_days}),/*#__PURE__*/_jsx(\"td\",{children:new Date(leave.from_date).toLocaleDateString()}),/*#__PURE__*/_jsx(\"td\",{children:new Date(leave.to_date).toLocaleDateString()})]},leave.id))})]})}),isOverlayOpen&&selectedLeave&&/*#__PURE__*/_jsx(\"div\",{className:\"overlay fade-in\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"overlay-content slide-up\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Leave Request Details\"}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Leave Type:\"}),\" \",selectedLeave.leaveType]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Reason:\"}),\" \",selectedLeave.description]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Approved/Rejected By:\"}),\" \",selectedLeave.approved_by_name||selectedLeave.rejected_by_name||'N/A']}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Rejected Description:\"}),\" \",selectedLeave.rejection_reason||'N/A']}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"No of Days:\"}),\" \",selectedLeave.no_of_days]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"From:\"}),\" \",new Date(selectedLeave.from_date).toLocaleDateString()]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"To:\"}),\" \",new Date(selectedLeave.to_date).toLocaleDateString()]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleCloseOverlay,className:\"close-btn\",children:\"Close\"}),\" \\xA0\",/*#__PURE__*/_jsx(\"button\",{style:{background:'red'},onClick:()=>cancelRequest(selectedLeave.id),children:\"cancelRequest\"})]})})]});}","map":{"version":3,"names":["React","useState","useEffect","axios","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","LeaveHistory","leaveHistory","setLeaveHistory","error","setError","selectedLeave","setSelectedLeave","isOverlayOpen","setIsOverlayOpen","user","JSON","parse","localStorage","getItem","get","params","userId","id","then","response","data","history","catch","err","console","handleViewRequest","leave","cancelRequest","handleCloseOverlay","delete","lrId","log","status","className","children","length","map","index","onClick","leaveType","description","for","steps_completed","steps_required","value","max","approved_by_name","rejected_by_name","rejection_reason","no_of_days","Date","from_date","toLocaleDateString","to_date","style","background"],"sources":["D:/Leave-management-system/frontend/src/pages/LeaveHistory.jsx"],"sourcesContent":["// frontend/src/pages/LeaveHistory.js\r\nimport React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\n\r\nexport default function LeaveHistory() {\r\n  const [leaveHistory, setLeaveHistory] = useState([]);\r\n  const [error, setError] = useState(null);\r\n  const [selectedLeave, setSelectedLeave] = useState(null);\r\n  const [isOverlayOpen, setIsOverlayOpen] = useState(false);\r\n\r\n  const user = JSON.parse(localStorage.getItem('user'));\r\n\r\n  useEffect(() => {\r\n    if (!user) return;\r\n\r\n    axios\r\n      .get('http://localhost:5000/api/leave/history', {\r\n        params: { userId: user.id }\r\n      })\r\n      .then((response) => {\r\n        setLeaveHistory(response.data.history);\r\n        setError(null);\r\n      })\r\n      .catch((err) => {\r\n        setError('Failed to fetch leave history.');\r\n        console.error(err);\r\n      });\r\n  }, [user]);\r\n\r\n  const handleViewRequest = (leave) => {\r\n    cancelRequest(leave);\r\n    setSelectedLeave(leave);\r\n    setIsOverlayOpen(true);\r\n  };\r\n\r\n\r\n  const handleCloseOverlay = () => {\r\n    setIsOverlayOpen(false);\r\n    setSelectedLeave(null);\r\n  };\r\n\r\n  async function cancelRequest(id){\r\n    await axios\r\n      .delete('http://localhost:5000/api/leave/deleteRequest', {\r\n        params: { lrId: id }\r\n      })\r\n      .then((response) => {\r\n        console.log(response.data.status)\r\n      })\r\n      .catch((err) => {\r\n        console.log(err);\r\n      });\r\n  }\r\n\r\n  return (\r\n    <div className=\"leave-history\">\r\n      {error && <p className=\"error\">{error}</p>}\r\n\r\n      <div className=\"table-wrapper\">\r\n        {leaveHistory.length ==0 ? <>NO LEAVE REQUESTED</> : \r\n        <table className=\"styled-table\">\r\n          <thead>\r\n            <tr>\r\n              <th>No</th>\r\n              <th>Leave Type</th>\r\n              <th>Reason</th>\r\n              <th>Status</th>\r\n              <th>Approved/Rejected By</th>\r\n              <th>Rejected Description</th>\r\n              <th>No of Days</th>\r\n              <th>From</th>\r\n              <th>To</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {leaveHistory.map((leave, index) => (\r\n              <tr key={leave.id} onClick={() => handleViewRequest(leave)}>\r\n                <td>{index + 1}</td>\r\n                <td>{leave.leaveType}</td>\r\n                <td>{leave.description}</td>\r\n                <td>{ leave.status } <label for=\"file\">({leave.steps_completed}/{leave.steps_required})</label><progress id='file' value={leave.steps_completed} max={leave.steps_required}></progress></td>\r\n                <td>{leave.approved_by_name || leave.rejected_by_name || '-'}</td>\r\n                <td>{leave.rejection_reason || '-'}</td>\r\n                <td>{leave.no_of_days}</td>\r\n                <td>{new Date(leave.from_date).toLocaleDateString()}</td>\r\n                <td>{new Date(leave.to_date).toLocaleDateString()}</td>\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>}\r\n      </div>\r\n\r\n        {isOverlayOpen && selectedLeave && (\r\n          <div className=\"overlay fade-in\">\r\n            <div className=\"overlay-content slide-up\">\r\n              <h3>Leave Request Details</h3>\r\n              <p><strong>Leave Type:</strong> {selectedLeave.leaveType}</p>\r\n              <p><strong>Reason:</strong> {selectedLeave.description}</p>\r\n              <p><strong>Approved/Rejected By:</strong> {selectedLeave.approved_by_name || selectedLeave.rejected_by_name || 'N/A'}</p>\r\n              <p><strong>Rejected Description:</strong> {selectedLeave.rejection_reason || 'N/A'}</p>\r\n              <p><strong>No of Days:</strong> {selectedLeave.no_of_days}</p>\r\n              <p><strong>From:</strong> {new Date(selectedLeave.from_date).toLocaleDateString()}</p>\r\n              <p><strong>To:</strong> {new Date(selectedLeave.to_date).toLocaleDateString()}</p>\r\n              <button onClick={handleCloseOverlay} className=\"close-btn\">Close</button> &nbsp;\r\n              <button style={{background: 'red'}} onClick={()=>cancelRequest(selectedLeave.id)}>cancelRequest</button>\r\n            </div>\r\n          </div>\r\n        )}\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}