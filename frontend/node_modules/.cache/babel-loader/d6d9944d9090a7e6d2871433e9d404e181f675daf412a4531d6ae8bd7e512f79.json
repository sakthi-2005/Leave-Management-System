{"ast":null,"code":"import React,{useState}from'react';import Papa from'papaparse';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function BulkImport(_ref){let{onClose}=_ref;const[parsedUsers,setParsedUsers]=useState([]);const[error,setError]=useState('');const handleFileChange=e=>{const file=e.target.files[0];if(!file){setError('Please upload a valid CSV file.');return;}Papa.parse(file,{header:true,skipEmptyLines:true,complete:results=>{console.log(results.data);const validUsers=results.data.map(row=>{var _row$name,_row$email,_row$position,_row$Manager,_row$password;return{name:(_row$name=row.name)===null||_row$name===void 0?void 0:_row$name.trim(),email:(_row$email=row.email)===null||_row$email===void 0?void 0:_row$email.trim(),position:(_row$position=row.position)===null||_row$position===void 0?void 0:_row$position.trim(),ManagerId:(_row$Manager=row.Manager)===null||_row$Manager===void 0?void 0:_row$Manager.trim(),password:(_row$password=row.password)===null||_row$password===void 0?void 0:_row$password.trim(),isAdmin:row.isAdmin};}).filter(user=>user.name&&user.email&&user.position&&user.ManagerId&&user.password&&user.isAdmin);setParsedUsers(validUsers);setError('');if(validUsers.length==0){setError('no User to Add');}},error:()=>{setError('Failed to parse CSV. Please try again.');}});};const handleImport=async()=>{if(parsedUsers.length>0){await axios.post('http://localhost:5000/api/admin/addUser',{params:{data:parsedUsers}}).then(response=>{console.log(response.data.status);onClose();}).catch(err=>{console.log(err);});setParsedUsers([]);}else{setError('no users in this file');}};return/*#__PURE__*/_jsxs(\"div\",{className:\"admin-bulk-import\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"admin-upload-label\",children:[\"\\uD83D\\uDCC1 Upload CSV\",/*#__PURE__*/_jsx(\"input\",{type:\"file\",onChange:handleFileChange,className:\"admin-file-input\"})]}),error&&/*#__PURE__*/_jsx(\"p\",{className:\"admin-error\",children:error}),parsedUsers.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"admin-preview\",children:[/*#__PURE__*/_jsxs(\"h4\",{children:[\"Preview (\",parsedUsers.length,\" users):\"]}),/*#__PURE__*/_jsx(\"ul\",{children:parsedUsers.map((user,idx)=>/*#__PURE__*/_jsxs(\"li\",{children:[user.name,\" \\u2014 \",user.position]},idx))}),/*#__PURE__*/_jsx(\"button\",{className:\"admin-button\",onClick:handleImport,children:\"Import Users\"})]})]});}export default BulkImport;","map":{"version":3,"names":["React","useState","Papa","axios","jsx","_jsx","jsxs","_jsxs","BulkImport","_ref","onClose","parsedUsers","setParsedUsers","error","setError","handleFileChange","e","file","target","files","parse","header","skipEmptyLines","complete","results","console","log","data","validUsers","map","row","_row$name","_row$email","_row$position","_row$Manager","_row$password","name","trim","email","position","ManagerId","Manager","password","isAdmin","filter","user","length","handleImport","post","params","then","response","status","catch","err","className","children","type","onChange","idx","onClick"],"sources":["D:/Leave-management-system/frontend/src/admin/bulkimport.jsx"],"sourcesContent":["import React, { useState } from 'react';\r\nimport Papa from 'papaparse';\r\nimport axios from 'axios';\r\n\r\nfunction BulkImport({onClose}) {\r\n  const [parsedUsers, setParsedUsers] = useState([]);\r\n  const [error, setError] = useState('');\r\n\r\n  const handleFileChange = (e) => {\r\n    const file = e.target.files[0];\r\n    if (!file) {\r\n      setError('Please upload a valid CSV file.');\r\n      return;\r\n    }\r\n\r\n    Papa.parse(file, {\r\n      header: true,\r\n      skipEmptyLines: true,\r\n      complete: (results) => {\r\n        console.log(results.data)\r\n        const validUsers = results.data\r\n          .map(row => ({\r\n            name: row.name?.trim(),\r\n            email: row.email?.trim(),\r\n            position: row.position?.trim(),\r\n            ManagerId: row.Manager?.trim(),\r\n            password: row.password?.trim(),\r\n            isAdmin: row.isAdmin\r\n          }))\r\n          .filter(user => user.name && user.email && user.position && user.ManagerId && user.password && user.isAdmin);\r\n        setParsedUsers(validUsers);\r\n        setError('');\r\n        if(validUsers.length == 0){\r\n          setError('no User to Add');\r\n        }\r\n      },\r\n      error: () => {\r\n        setError('Failed to parse CSV. Please try again.');\r\n      }\r\n    });\r\n  };\r\n\r\n  const handleImport = async() => {\r\n    if (parsedUsers.length > 0) {\r\n      await axios\r\n      .post('http://localhost:5000/api/admin/addUser', {\r\n        params: { data: parsedUsers }\r\n      })\r\n      .then((response) => {\r\n        console.log(response.data.status);\r\n        onClose()\r\n      })\r\n      .catch((err) => {\r\n        console.log(err);\r\n      });\r\n      setParsedUsers([]);\r\n    }\r\n    else{\r\n      setError('no users in this file')\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"admin-bulk-import\">\r\n      <label className=\"admin-upload-label\">\r\n        üìÅ Upload CSV\r\n        <input type=\"file\" onChange={handleFileChange} className=\"admin-file-input\" />\r\n      </label>\r\n      {error && <p className=\"admin-error\">{error}</p>}\r\n\r\n      {parsedUsers.length > 0 && (\r\n        <div className=\"admin-preview\">\r\n          <h4>Preview ({parsedUsers.length} users):</h4>\r\n          <ul>\r\n            {parsedUsers.map((user, idx) => (\r\n              <li key={idx}>\r\n                {user.name} ‚Äî {user.position}\r\n              </li>\r\n            ))}\r\n          </ul>\r\n          <button className=\"admin-button\" onClick={handleImport}>Import Users</button>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default BulkImport;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}