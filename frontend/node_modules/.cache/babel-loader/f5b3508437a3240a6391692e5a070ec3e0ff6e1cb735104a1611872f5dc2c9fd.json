{"ast":null,"code":"import{useState,useEffect}from\"react\";import axios from\"axios\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export function RequestPage(_ref){let{leaveBalances,setIsRequestLeaveVisible,user,setToastColor,setToastMessage,setToastVisible}=_ref;const[leaveType,setLeaveType]=useState(\"0\");const[fromDate,setFromDate]=useState(\"\");const[toDate,setToDate]=useState(\"\");const[reason,setReason]=useState(\"\");const[workingDays,setWorkingDays]=useState(0);let[holidays,setHolidays]=useState([]);useEffect(()=>{const fetchHolidays=async()=>{await axios.get('http://localhost:5000/api/leave/holiday').then(response=>{// holidays = [...response];\nsetHolidays(response.data.holidays);}).catch(err=>{console.log(err);});};fetchHolidays();},[]);useEffect(()=>{if(!fromDate||!toDate){setWorkingDays(0);return;}const from=new Date(fromDate);const to=new Date(toDate);let count=0;for(let d=new Date(from);d<=to;d.setDate(d.getDate()+1)){const day=d.getDay();const isoDate=d.toISOString().split(\"T\")[0];if(day!==0&&day!==6&&!holidays.includes(isoDate)){count++;}}setWorkingDays(count);},[fromDate,toDate]);async function handleSubmit(e){e.preventDefault();if(leaveBalances[Number(leaveType)].remainingLeaves<workingDays){alert('insufficient Leave Balance');return;}try{const response=await axios.post('http://localhost:5000/api/leave/request',{type:Number(leaveType)+1,from:fromDate,to:toDate,reason:reason,userId:user.id,noOfDays:workingDays});if(response.data.status=='updated'){setToastVisible(true);setToastColor('green');setToastMessage('Request Sent Successfully');setIsRequestLeaveVisible(false);}}catch(error){setToastVisible(true);setToastColor('red');setToastMessage('request failed!');}}return/*#__PURE__*/_jsx(\"div\",{className:\"requestLeave-backdrop\",onClick:()=>setIsRequestLeaveVisible(false),children:/*#__PURE__*/_jsxs(\"div\",{className:\"requestLeave-box animated-slide\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Request Leave\"}),/*#__PURE__*/_jsxs(\"form\",{className:\"requestLeave-form\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"label\",{children:[\"Leave Type:\",/*#__PURE__*/_jsxs(\"select\",{name:\"leaveType\",value:leaveType,onChange:e=>setLeaveType(e.target.value),required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"0\",children:\"Sick Leave\"}),/*#__PURE__*/_jsx(\"option\",{value:\"1\",children:\"Casual Leave\"}),/*#__PURE__*/_jsx(\"option\",{value:\"2\",children:\"Work From Home\"}),/*#__PURE__*/_jsx(\"option\",{value:\"3\",children:\"On Duty\"}),/*#__PURE__*/_jsx(\"option\",{value:\"4\",children:\"Loss-of-pay\"})]}),\" \",/*#__PURE__*/_jsx(\"br\",{}),\" Reamining: \",/*#__PURE__*/_jsx(_Fragment,{children:leaveBalances[Number(leaveType)].remainingLeaves>30?Infinity:leaveBalances[Number(leaveType)].remainingLeaves||0})]}),/*#__PURE__*/_jsxs(\"label\",{children:[\"From Date:\",/*#__PURE__*/_jsx(\"input\",{name:\"fromDate\",type:\"date\",min:new Date().toISOString().split('T')[0],value:fromDate,onChange:e=>setFromDate(e.target.value),required:true,disabled:leaveBalances[Number(leaveType)].remainingLeaves==0})]}),workingDays!=0?/*#__PURE__*/_jsxs(_Fragment,{children:[\"Required: \",workingDays,\" \",/*#__PURE__*/_jsx(\"br\",{}),\" \",/*#__PURE__*/_jsx(\"br\",{})]}):null,/*#__PURE__*/_jsxs(\"label\",{children:[\"To Date:\",/*#__PURE__*/_jsx(\"input\",{name:\"toDate\",type:\"date\",min:fromDate,value:toDate,onChange:e=>setToDate(e.target.value),required:true,disabled:leaveBalances[Number(leaveType)].remainingLeaves==0})]}),/*#__PURE__*/_jsxs(\"label\",{children:[\"Reason:\",/*#__PURE__*/_jsx(\"textarea\",{name:\"reason\",rows:\"4\",value:reason,onChange:e=>setReason(e.target.value),required:true,disabled:leaveBalances[Number(leaveType)].remainingLeaves==0})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"requestLeave-actions\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Submit\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setIsRequestLeaveVisible(false),children:\"Cancel\"})]})]})]})});}","map":{"version":3,"names":["useState","useEffect","axios","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","RequestPage","_ref","leaveBalances","setIsRequestLeaveVisible","user","setToastColor","setToastMessage","setToastVisible","leaveType","setLeaveType","fromDate","setFromDate","toDate","setToDate","reason","setReason","workingDays","setWorkingDays","holidays","setHolidays","fetchHolidays","get","then","response","data","catch","err","console","log","from","Date","to","count","d","setDate","getDate","day","getDay","isoDate","toISOString","split","includes","handleSubmit","e","preventDefault","Number","remainingLeaves","alert","post","type","userId","id","noOfDays","status","error","className","onClick","children","stopPropagation","onSubmit","name","value","onChange","target","required","Infinity","min","disabled","rows"],"sources":["D:/Leave-management-system/frontend/src/components/requestPage.jsx"],"sourcesContent":["import { useState,useEffect } from \"react\";\r\nimport axios from \"axios\";\r\n\r\nexport function RequestPage( { leaveBalances, setIsRequestLeaveVisible , user ,setToastColor , setToastMessage, setToastVisible } ){\r\n    \r\n\r\n    const [leaveType, setLeaveType] = useState(\"0\");\r\n    const [fromDate, setFromDate] = useState(\"\");\r\n    const [toDate, setToDate] = useState(\"\");\r\n    const [reason, setReason] = useState(\"\");\r\n    const [workingDays, setWorkingDays] = useState(0);\r\n    let [holidays,setHolidays] = useState([]);\r\n\r\n    useEffect(()=>{\r\n        const fetchHolidays = async () => {\r\n            await axios\r\n              .get('http://localhost:5000/api/leave/holiday')\r\n              .then((response) => {\r\n                // holidays = [...response];\r\n                setHolidays(response.data.holidays);\r\n              })\r\n              .catch((err) => {\r\n                console.log(err);\r\n              });\r\n        }\r\n        fetchHolidays();\r\n    },[])\r\n\r\n    useEffect(() => {\r\n        if (!fromDate || !toDate) {\r\n          setWorkingDays(0);\r\n          return;\r\n        }\r\n      \r\n        const from = new Date(fromDate);\r\n        const to = new Date(toDate);\r\n        let count = 0;\r\n      \r\n        for (let d = new Date(from); d <= to; d.setDate(d.getDate() + 1)) {\r\n          const day = d.getDay();\r\n          const isoDate = d.toISOString().split(\"T\")[0];\r\n          if (day !== 0 && day !== 6 && !holidays.includes(isoDate)) {\r\n            count++;\r\n          }\r\n        }\r\n          setWorkingDays(count);\r\n    }, [fromDate, toDate]);\r\n\r\n\r\n    async function handleSubmit(e){\r\n        e.preventDefault();\r\n\r\n        if(leaveBalances[Number(leaveType)].remainingLeaves < workingDays){\r\n          alert('insufficient Leave Balance');\r\n          return;\r\n        }\r\n\r\n        try {\r\n        const response = await axios.post('http://localhost:5000/api/leave/request', {type: (Number(leaveType)+1) , from: fromDate , to: toDate , reason: reason , userId:user.id , noOfDays: workingDays});\r\n        if(response.data.status == 'updated'){\r\n          setToastVisible(true);\r\n          setToastColor('green');\r\n          setToastMessage('Request Sent Successfully');\r\n          setIsRequestLeaveVisible(false);\r\n        }\r\n        } catch (error) {\r\n          setToastVisible(true);\r\n          setToastColor('red');\r\n          setToastMessage('request failed!');\r\n        }\r\n\r\n    }\r\n\r\n\r\n    return (\r\n        <div className=\"requestLeave-backdrop\" onClick={() => setIsRequestLeaveVisible(false)}>\r\n                  <div className=\"requestLeave-box animated-slide\" onClick={(e) => e.stopPropagation()}>\r\n                    <h2>Request Leave</h2>\r\n                    <form className=\"requestLeave-form\" onSubmit={handleSubmit}>\r\n                      <label>\r\n                        Leave Type:\r\n                        <select name='leaveType' value={leaveType} onChange={(e) => setLeaveType(e.target.value)} required>\r\n                          <option value=\"0\">Sick Leave</option>\r\n                          <option value=\"1\">Casual Leave</option>\r\n                          <option value=\"2\">Work From Home</option>\r\n                          <option value=\"3\">On Duty</option>\r\n                          <option value=\"4\">Loss-of-pay</option>\r\n                        </select> <br /> Reamining: <>{leaveBalances[Number(leaveType)].remainingLeaves > 30 ? Infinity : leaveBalances[Number(leaveType)].remainingLeaves || 0}</>\r\n                      </label>\r\n                      <label>\r\n                        From Date:\r\n                        <input name='fromDate' type=\"date\" min={new Date().toISOString().split('T')[0]} value={fromDate} onChange={(e) => setFromDate(e.target.value)} required disabled={leaveBalances[Number(leaveType)].remainingLeaves == 0}/>\r\n                      </label>\r\n                      {workingDays != 0 ? <>Required: {workingDays} <br /> <br /></>: null}\r\n                      <label>\r\n                        To Date:\r\n                        <input name='toDate' type=\"date\" min={fromDate} value={toDate} onChange={(e) => setToDate(e.target.value)} required disabled={leaveBalances[Number(leaveType)].remainingLeaves == 0}/>\r\n                      </label>\r\n\r\n                      <label>\r\n                        Reason:\r\n                        <textarea name='reason' rows=\"4\" value={reason} onChange={(e) => setReason(e.target.value)} required disabled={leaveBalances[Number(leaveType)].remainingLeaves == 0}/>\r\n                      </label>\r\n                      <div className=\"requestLeave-actions\">\r\n                        <button type=\"submit\">Submit</button>\r\n                        <button type=\"button\" onClick={() => setIsRequestLeaveVisible(false)}>Cancel</button>\r\n                      </div>\r\n                    </form>\r\n                  </div>\r\n                </div>\r\n    )\r\n}"],"mappings":"AAAA,OAASA,QAAQ,CAACC,SAAS,KAAQ,OAAO,CAC1C,MAAO,CAAAC,KAAK,KAAM,OAAO,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,CAAAC,QAAA,IAAAC,SAAA,yBAE1B,MAAO,SAAS,CAAAC,WAAWA,CAAAC,IAAA,CAAwG,IAAtG,CAAEC,aAAa,CAAEC,wBAAwB,CAAGC,IAAI,CAAEC,aAAa,CAAGC,eAAe,CAAEC,eAAgB,CAAC,CAAAN,IAAA,CAG7H,KAAM,CAACO,SAAS,CAAEC,YAAY,CAAC,CAAGlB,QAAQ,CAAC,GAAG,CAAC,CAC/C,KAAM,CAACmB,QAAQ,CAAEC,WAAW,CAAC,CAAGpB,QAAQ,CAAC,EAAE,CAAC,CAC5C,KAAM,CAACqB,MAAM,CAAEC,SAAS,CAAC,CAAGtB,QAAQ,CAAC,EAAE,CAAC,CACxC,KAAM,CAACuB,MAAM,CAAEC,SAAS,CAAC,CAAGxB,QAAQ,CAAC,EAAE,CAAC,CACxC,KAAM,CAACyB,WAAW,CAAEC,cAAc,CAAC,CAAG1B,QAAQ,CAAC,CAAC,CAAC,CACjD,GAAI,CAAC2B,QAAQ,CAACC,WAAW,CAAC,CAAG5B,QAAQ,CAAC,EAAE,CAAC,CAEzCC,SAAS,CAAC,IAAI,CACV,KAAM,CAAA4B,aAAa,CAAG,KAAAA,CAAA,GAAY,CAC9B,KAAM,CAAA3B,KAAK,CACR4B,GAAG,CAAC,yCAAyC,CAAC,CAC9CC,IAAI,CAAEC,QAAQ,EAAK,CAClB;AACAJ,WAAW,CAACI,QAAQ,CAACC,IAAI,CAACN,QAAQ,CAAC,CACrC,CAAC,CAAC,CACDO,KAAK,CAAEC,GAAG,EAAK,CACdC,OAAO,CAACC,GAAG,CAACF,GAAG,CAAC,CAClB,CAAC,CAAC,CACR,CAAC,CACDN,aAAa,CAAC,CAAC,CACnB,CAAC,CAAC,EAAE,CAAC,CAEL5B,SAAS,CAAC,IAAM,CACZ,GAAI,CAACkB,QAAQ,EAAI,CAACE,MAAM,CAAE,CACxBK,cAAc,CAAC,CAAC,CAAC,CACjB,OACF,CAEA,KAAM,CAAAY,IAAI,CAAG,GAAI,CAAAC,IAAI,CAACpB,QAAQ,CAAC,CAC/B,KAAM,CAAAqB,EAAE,CAAG,GAAI,CAAAD,IAAI,CAAClB,MAAM,CAAC,CAC3B,GAAI,CAAAoB,KAAK,CAAG,CAAC,CAEb,IAAK,GAAI,CAAAC,CAAC,CAAG,GAAI,CAAAH,IAAI,CAACD,IAAI,CAAC,CAAEI,CAAC,EAAIF,EAAE,CAAEE,CAAC,CAACC,OAAO,CAACD,CAAC,CAACE,OAAO,CAAC,CAAC,CAAG,CAAC,CAAC,CAAE,CAChE,KAAM,CAAAC,GAAG,CAAGH,CAAC,CAACI,MAAM,CAAC,CAAC,CACtB,KAAM,CAAAC,OAAO,CAAGL,CAAC,CAACM,WAAW,CAAC,CAAC,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAC7C,GAAIJ,GAAG,GAAK,CAAC,EAAIA,GAAG,GAAK,CAAC,EAAI,CAAClB,QAAQ,CAACuB,QAAQ,CAACH,OAAO,CAAC,CAAE,CACzDN,KAAK,EAAE,CACT,CACF,CACEf,cAAc,CAACe,KAAK,CAAC,CAC3B,CAAC,CAAE,CAACtB,QAAQ,CAAEE,MAAM,CAAC,CAAC,CAGtB,cAAe,CAAA8B,YAAYA,CAACC,CAAC,CAAC,CAC1BA,CAAC,CAACC,cAAc,CAAC,CAAC,CAElB,GAAG1C,aAAa,CAAC2C,MAAM,CAACrC,SAAS,CAAC,CAAC,CAACsC,eAAe,CAAG9B,WAAW,CAAC,CAChE+B,KAAK,CAAC,4BAA4B,CAAC,CACnC,OACF,CAEA,GAAI,CACJ,KAAM,CAAAxB,QAAQ,CAAG,KAAM,CAAA9B,KAAK,CAACuD,IAAI,CAAC,yCAAyC,CAAE,CAACC,IAAI,CAAGJ,MAAM,CAACrC,SAAS,CAAC,CAAC,CAAE,CAAGqB,IAAI,CAAEnB,QAAQ,CAAGqB,EAAE,CAAEnB,MAAM,CAAGE,MAAM,CAAEA,MAAM,CAAGoC,MAAM,CAAC9C,IAAI,CAAC+C,EAAE,CAAGC,QAAQ,CAAEpC,WAAW,CAAC,CAAC,CACnM,GAAGO,QAAQ,CAACC,IAAI,CAAC6B,MAAM,EAAI,SAAS,CAAC,CACnC9C,eAAe,CAAC,IAAI,CAAC,CACrBF,aAAa,CAAC,OAAO,CAAC,CACtBC,eAAe,CAAC,2BAA2B,CAAC,CAC5CH,wBAAwB,CAAC,KAAK,CAAC,CACjC,CACA,CAAE,MAAOmD,KAAK,CAAE,CACd/C,eAAe,CAAC,IAAI,CAAC,CACrBF,aAAa,CAAC,KAAK,CAAC,CACpBC,eAAe,CAAC,iBAAiB,CAAC,CACpC,CAEJ,CAGA,mBACIX,IAAA,QAAK4D,SAAS,CAAC,uBAAuB,CAACC,OAAO,CAAEA,CAAA,GAAMrD,wBAAwB,CAAC,KAAK,CAAE,CAAAsD,QAAA,cAC5E5D,KAAA,QAAK0D,SAAS,CAAC,iCAAiC,CAACC,OAAO,CAAGb,CAAC,EAAKA,CAAC,CAACe,eAAe,CAAC,CAAE,CAAAD,QAAA,eACnF9D,IAAA,OAAA8D,QAAA,CAAI,eAAa,CAAI,CAAC,cACtB5D,KAAA,SAAM0D,SAAS,CAAC,mBAAmB,CAACI,QAAQ,CAAEjB,YAAa,CAAAe,QAAA,eACzD5D,KAAA,UAAA4D,QAAA,EAAO,aAEL,cAAA5D,KAAA,WAAQ+D,IAAI,CAAC,WAAW,CAACC,KAAK,CAAErD,SAAU,CAACsD,QAAQ,CAAGnB,CAAC,EAAKlC,YAAY,CAACkC,CAAC,CAACoB,MAAM,CAACF,KAAK,CAAE,CAACG,QAAQ,MAAAP,QAAA,eAChG9D,IAAA,WAAQkE,KAAK,CAAC,GAAG,CAAAJ,QAAA,CAAC,YAAU,CAAQ,CAAC,cACrC9D,IAAA,WAAQkE,KAAK,CAAC,GAAG,CAAAJ,QAAA,CAAC,cAAY,CAAQ,CAAC,cACvC9D,IAAA,WAAQkE,KAAK,CAAC,GAAG,CAAAJ,QAAA,CAAC,gBAAc,CAAQ,CAAC,cACzC9D,IAAA,WAAQkE,KAAK,CAAC,GAAG,CAAAJ,QAAA,CAAC,SAAO,CAAQ,CAAC,cAClC9D,IAAA,WAAQkE,KAAK,CAAC,GAAG,CAAAJ,QAAA,CAAC,aAAW,CAAQ,CAAC,EAChC,CAAC,IAAC,cAAA9D,IAAA,QAAK,CAAC,eAAY,cAAAA,IAAA,CAAAI,SAAA,EAAA0D,QAAA,CAAGvD,aAAa,CAAC2C,MAAM,CAACrC,SAAS,CAAC,CAAC,CAACsC,eAAe,CAAG,EAAE,CAAGmB,QAAQ,CAAG/D,aAAa,CAAC2C,MAAM,CAACrC,SAAS,CAAC,CAAC,CAACsC,eAAe,EAAI,CAAC,CAAG,CAAC,EACtJ,CAAC,cACRjD,KAAA,UAAA4D,QAAA,EAAO,YAEL,cAAA9D,IAAA,UAAOiE,IAAI,CAAC,UAAU,CAACX,IAAI,CAAC,MAAM,CAACiB,GAAG,CAAE,GAAI,CAAApC,IAAI,CAAC,CAAC,CAACS,WAAW,CAAC,CAAC,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAE,CAACqB,KAAK,CAAEnD,QAAS,CAACoD,QAAQ,CAAGnB,CAAC,EAAKhC,WAAW,CAACgC,CAAC,CAACoB,MAAM,CAACF,KAAK,CAAE,CAACG,QAAQ,MAACG,QAAQ,CAAEjE,aAAa,CAAC2C,MAAM,CAACrC,SAAS,CAAC,CAAC,CAACsC,eAAe,EAAI,CAAE,CAAC,CAAC,EACrN,CAAC,CACP9B,WAAW,EAAI,CAAC,cAAGnB,KAAA,CAAAE,SAAA,EAAA0D,QAAA,EAAE,YAAU,CAACzC,WAAW,CAAC,GAAC,cAAArB,IAAA,QAAK,CAAC,IAAC,cAAAA,IAAA,QAAK,CAAC,EAAE,CAAC,CAAE,IAAI,cACpEE,KAAA,UAAA4D,QAAA,EAAO,UAEL,cAAA9D,IAAA,UAAOiE,IAAI,CAAC,QAAQ,CAACX,IAAI,CAAC,MAAM,CAACiB,GAAG,CAAExD,QAAS,CAACmD,KAAK,CAAEjD,MAAO,CAACkD,QAAQ,CAAGnB,CAAC,EAAK9B,SAAS,CAAC8B,CAAC,CAACoB,MAAM,CAACF,KAAK,CAAE,CAACG,QAAQ,MAACG,QAAQ,CAAEjE,aAAa,CAAC2C,MAAM,CAACrC,SAAS,CAAC,CAAC,CAACsC,eAAe,EAAI,CAAE,CAAC,CAAC,EACjL,CAAC,cAERjD,KAAA,UAAA4D,QAAA,EAAO,SAEL,cAAA9D,IAAA,aAAUiE,IAAI,CAAC,QAAQ,CAACQ,IAAI,CAAC,GAAG,CAACP,KAAK,CAAE/C,MAAO,CAACgD,QAAQ,CAAGnB,CAAC,EAAK5B,SAAS,CAAC4B,CAAC,CAACoB,MAAM,CAACF,KAAK,CAAE,CAACG,QAAQ,MAACG,QAAQ,CAAEjE,aAAa,CAAC2C,MAAM,CAACrC,SAAS,CAAC,CAAC,CAACsC,eAAe,EAAI,CAAE,CAAC,CAAC,EAClK,CAAC,cACRjD,KAAA,QAAK0D,SAAS,CAAC,sBAAsB,CAAAE,QAAA,eACnC9D,IAAA,WAAQsD,IAAI,CAAC,QAAQ,CAAAQ,QAAA,CAAC,QAAM,CAAQ,CAAC,cACrC9D,IAAA,WAAQsD,IAAI,CAAC,QAAQ,CAACO,OAAO,CAAEA,CAAA,GAAMrD,wBAAwB,CAAC,KAAK,CAAE,CAAAsD,QAAA,CAAC,QAAM,CAAQ,CAAC,EAClF,CAAC,EACF,CAAC,EACJ,CAAC,CACH,CAAC,CAEtB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}